package com.qualitymap.action;

import javax.annotation.Resource;

import com.qualitymap.base.BaseAction;
import com.qualitymap.service.OverviewProvinceService;

/**
 * 省级纬度数据分析
 * 
 * @author：kxc
 * @date：Apr 12, 2016
 */
public class OverviewProvinceAction extends BaseAction {

	/**
	 * serialVersionUID long OverviewProvinceAction.java
	 */
	private static final long serialVersionUID = 1L;
	@Resource
	private OverviewProvinceService provinceService;

	/**
	 * 根据时间查询本月的测试次数
	 * 
	 * @return void
	 */
	public void findByMonth() {

		try {

			String month = this.servletRequest.getParameter("month");
			String uuid = this.servletRequest.getParameter("key");
			String groupid = this.getUserGroup(uuid);
			String datajson = provinceService.findByMonth(month, groupid);
			printWriter(datajson);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	/**
	 * 查询所有的数据
	 * 
	 * @return void
	 */
	public void findAll() {
		String uuid = this.servletRequest.getParameter("key");
		String groupid = this.getUserGroup(uuid);
		String datajson = provinceService.findProvice(groupid);
		printWriter(datajson);
	}

	/**
	 * 获取签约带宽占比
	 * 
	 * @return void
	 */
	public void getBroadbandData() {

		try {
			String month = this.servletRequest.getParameter("month");
			String uuid = this.servletRequest.getParameter("key");
			String groupid = this.getUserGroup(uuid);
			String broadbandData = provinceService.getBroadbandData(month, groupid);
			printWriter(broadbandData);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	/**
	 * 获取各省用户占比
	 * 
	 * @return void
	 */
	public void getProvinceUserPercent() {

		try {
			String month = this.servletRequest.getParameter("month");
			String uuid = this.servletRequest.getParameter("key");
			String groupid = this.getUserGroup(uuid);
			//String groupid = "10,12";
			String provinceUserData = provinceService.getProvinceUserPercent(month, groupid);
			printWriter(provinceUserData);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	
	/**
	 * 获取宽带类型累计和本月用户数
	 */
	public void getBroadbandTypeData() {

		try {
			String month = this.servletRequest.getParameter("month");
			String uuid = this.servletRequest.getParameter("key");
			String groupid = this.getUserGroup(uuid);
			String msg = provinceService.getBroadbandTypeData(month,groupid);
			printWriter(msg);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	
	/**
	 * 根据groupid，month获取样本总数
	 * 
	 * @return void
	 */
	public void getTotalSampleNum() {
		try {
			String month = this.servletRequest.getParameter("month");
			String groupid = this.servletRequest.getParameter("groupid");  //页面获取指定groupid
			String broadType = this.servletRequest.getParameter("broadType");
			String new_sample_num = provinceService.getTotalSampleNum(month, groupid,broadType);
			printWriter(new_sample_num);
		} catch (Exception e) {
			// TODO: handle exception
			e.printStackTrace();
		}
	}
}
